# Предсказание температуры стали

## Описание проекта

Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали. Нам предстоит построить модель, которая предскажет температуру стали.

Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены в крышке ковша.

Из сплава выводится сера (десульфурация), добавлением примесей корректируется химический состав и отбираются пробы. Сталь легируют — изменяют её состав — подавая куски сплава из бункера для сыпучих материалов или проволоку через специальный трайб-аппарат (англ. tribe, «масса»).

Перед тем как первый раз ввести легирующие добавки, измеряют температуру стали и производят её химический анализ. Потом температуру на несколько минут повышают, добавляют легирующие материалы и продувают сплав инертным газом. Затем его перемешивают и снова проводят измерения. Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.

Тогда расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (англ. slab, «плита»).

## Данные

В наличии были следующие данные:

Данные состоят из файлов, полученных из разных источников:
- данные об электродах;
- данные о подаче сыпучих материалов (объём);
- данные о подаче сыпучих материалов (время);
- данные о продувке сплава газом;
- результаты измерения температуры;
- данные о проволочных материалах (объём);
- данные о проволочных материалах (время).

Во всех файлах столбец `key` содержит номер партии. В файлах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.

## Задача
 
Построить модель предсказания температуры стали в ковше.

## Используемые библиотеки
*pandas, numpy, matplotlib, seaborn, sklearn, lightgbm, warnings*

## Выводы

Провели предобработку данных. Удалили выбросы с низкой температурой (менее 1300 градусов) и аномальные значения реактивной мощности (-715).
Удалили из обучения материалы `wire 6, 3, 9, 8, 4, 7, 5` и `bulk 1, 11, 10, 5, 7, 2, 9, 13, 8` т.к. они использовались в менее 10% партий.
Собрали все данные в единый датасет: восстановили логику работы ковша и смоделировали весь процесс в хнологическом порядке. Объединили все итерации одной партии в одну строку, оставив важные для партии признаки. Провели оценку новых признаков на мультиколлинеарность. Протестировали 4 модели: Лассо, Случайный лес, Ридж и LightGBM. На кросс-валидации лучшей оказалась модель Лассо: MAE 6.13 на обучающей выборке. На тестовой выборке лучшая модель показала MAE 5.82. Самыми важными признаками для предсказания оказались стартовая температура по партии, длительность нагревания и  объем материала `wire_1`. Для решения данной задачи рекомендуется модель Лассо с гипперпараметрами `alpha=0.03`. Проект завершён.